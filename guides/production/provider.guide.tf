# ==========================================================
# 📌 Terraform の基本設定（バージョン・プロバイダー・バックエンド）
# ==========================================================

terraform {
  # ✅ Terraform のバージョン指定（1.10.0 以上 2.0 未満）
  required_version = "~> 1.10.0"

  # ✅ 必要なプロバイダーを指定
  required_providers {
    aws = {
      source  = "hashicorp/aws"  # HashiCorp の AWS プロバイダーを使用
      version = "~> 5.0"         # AWS プロバイダーのバージョン（5.0 以上 6.0 未満）
    }
  }

  # ==========================================================
  # 📌 Terraform の状態ファイルを S3 に保存（リモートバックエンド）
  # ==========================================================
  backend "s3" {
    bucket       = "my-app-terraform-state-bucket"  # 🔹 S3 バケットの名前
    key          = "production/terraform.tfstate"  # 🔹 S3 内のファイルパス
    region       = "ap-northeast-1"                # 🔹 S3 バケットのリージョン（東京）
    use_lockfile = true                            # 🔹 ロックファイルを使って競合を防ぐ
    encrypt      = true                            # 🔹 状態ファイルを暗号化
  }
}

# ==========================================================
# 📌 AWS プロバイダーの設定
# ==========================================================

provider "aws" {
  region = var.aws_region  # 🔹 変数 `aws_region` で指定されたリージョンを使用
}
